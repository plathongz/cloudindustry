%%[
    var @subKey, @hasContact , @getListName , @getListId  , @firstTitle, @FiledId

    /* get plan */
    IF EMPTY(RequestParameter('subscriberKey')) THEN
        set @accountName = "iSwitch Mockup Data "
        set @address = "I Switch Pte Ltd 120 Robinson Road, #14-01, Singapore 068913"
        set @endContract = Format(NOW(), "MMMM d, yyyy")
        set @accountNumber = "SW0000000001"
        set @chargeDescription1 = "chargeDescription1"
        set @chargeDescription2 = "chargeDescription2"
        set @chargeDescription3 = "chargeDescription3"
        set @chargeDescription4 = "chargeDescription4"
        set @pricePlanName1 = "pricePlanName1 "
        set @pricePlanName2 = "pricePlanName2 "
        set @pricePlanName3 = "pricePlanName3 "
        set @pricePlanName4 = "pricePlanName4 "
        set @pricePlan1 = "pricePlanName1"
        set @pricePlan2 = "pricePlanName2"
        set @pricePlan3 = "pricePlanName3"
        set @pricePlan4 = "pricePlanName4"
        set @totalSavings = "450"
        set @company = "Company Mockup"
    ELSE
        set @subKey = RequestParameter('subscriberKey')
        set @Id = RequestParameter('customerRenewalPricePlansId')
        set @listData = LookupRows('Renewal_B2B_DE',"Id", @Id)
        set @countListData = rowcount(@listData)
        if @countListData > 0 then
            for @j = 1 to @countListData do
                set @row = Row(@listData, @j)
                set @selected_Renewal = Field(@row ,'Selected_Renewal_Plan_Code')
                set @firstname = Field(@row ,'First_Name__c')
                set @lastname = Field(@row ,'Last_Name__c')
	            set @fullname = Field(@row ,'Name')
                set @address = Field(@row ,'Premise_Address__c')
                set @ContractEndDate = Field(@row ,'Contract_End_Date__c')
                set @accountNumber = Field(@row ,'iSwitch_Customer_Account_Number__c')
             	set @chargeDescription1 = Field(@row ,'Charge_Description_5__c')
                set @chargeDescription2 = Field(@row ,'Charge_Description_6__c')
                set @chargeDescription3 = Field(@row ,'Charge_Description_7__c')
                set @chargeDescription4 = Field(@row ,'Charge_Description_8__c')
	            set @factsheet1 = Field(@row ,'Factsheet_5__c')
                set @factsheet2 = Field(@row ,'Factsheet_6__c')
                set @factsheet3 = Field(@row ,'Factsheet_7__c')
                set @factsheet4 = Field(@row ,'Factsheet_8__c')
                set @totalSavings = Field(@row ,'Total_Savings__c')
	            set @pricePlanName1 = Field(@row ,'Price_Plan_Name_5__c')
                set @pricePlanName2 = Field(@row ,'Price_Plan_Name_6__c')
                set @pricePlanName3 = Field(@row ,'Price_Plan_Name_7__c')
                set @pricePlanName4 = Field(@row ,'Price_Plan_Name_8__c')
                set @pricePlan1 = Field(@row ,'Renewal_Price_Plan_5__c')
                set @pricePlan2 = Field(@row ,'Renewal_Price_Plan_6__c')
                set @pricePlan3 = Field(@row ,'Renewal_Price_Plan_7__c')
                set @pricePlan4 = Field(@row ,'Renewal_Price_Plan_8__c')
                set @company = Field(@row ,'Company__c')
                
            next @j 

        set @accountName = @fullname
        set @endContract = Format(@ContractEndDate, "MMMM d, yyyy")

        UpdateData('Renewal_B2B_DE',1,'Id',@Id,'Open_LP2',1,'Open_LP2_Time',NOW())

        else 
            OUTPUT(CONCAT("No data in DE"))
        endif   

    ENDIF
]%%
